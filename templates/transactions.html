{% extends "layout.html" %}

{% block content %}

<div style="text-align: center; margin-top: 1rem;">
    <h1 class="title">Transactions</h1>
    <button class="button is-large is-rounded" id="add-transaction" style="margin-top: 1rem;">Add Transaction</button>
</div>

<div id="add-transaction-modal" class="modal">
  <div class="modal-background"></div>
  <div class="modal-content">
    <div class="box">
      <form method="post" action="/add_transaction">
        <div class="field">
          <label class="label">Date</label>
          <div class="control">
            <input class="input" type="date" name="date" required>
          </div>
        </div>

        <div class="field">
          <label class="label">Description</label>
          <div class="control">
            <input class="input" type="text" name="description" placeholder="Description" required>
          </div>
        </div>

        <div class="field">
          <label class="label">Category</label>
          <div class="control">
            <div class="select is-fullwidth">
              <select name="category" required>
                <option disabled selected value>Select Category</option>
                {% for category in categories %}
                <option value="{{ category.name }}">{{ category.name }}</option>
                {% endfor %}
              </select> 
              </div>             
        </div>
        </div>

        <div class="field">
          <label class="label">Amount</label>
          <div class="control">
            <input class="input" type="number" step="0.01" name="amount" placeholder="Amount" required>
          </div>
        </div>

        <div class="field">
          <label class="label">Account</label>
          <div class="control">
            <div class="select is-fullwidth">
              <select name="account_id" required>
                <option disabled selected value>Select Account</option>
                {% for account in accounts %}
                <option value="{{ account.id }}">{{ account.name }}</option>
                {% endfor %}
              </select>
            </div>
          </div>
        </div>

        <div class="field is-grouped is-grouped-centered" style="margin-top: 1rem;">
          <div class="control">
            <button class="button is-primary is-rounded" type="submit">Add Transaction</button>
          </div>
          <div class="control">
            <button type="button" class="button is-light is-rounded" id="cancel-button">Cancel</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="container">
    <table class="table is-fullwidth is-striped is-hoverable" style="margin-top: 2rem;">
        <thead>
            <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Category</th>
                <th>Amount</th>
                <th>Account</th>
            </tr>
        </thead>
        <tbody>
            {% for transaction in transactions %}
            <tr>
                <td>{{ transaction.date }}</td>
                <td>{{ transaction.description }}</td>
                <td>{{ transaction.category }}</td>
                <td>${{ '%.2f'|format(transaction.amount) }}</td>
                <td>{{ transaction.account_name }}</td>
            </tr>
            {% endfor %}
        </tbody>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const addTransactionButton = document.getElementById('add-transaction');
    const modal = document.getElementById('add-transaction-modal');
    const cancelButton = document.getElementById('cancel-button');
    const modalClose = modal.querySelector('.modal-close');

    addTransactionButton.addEventListener('click', () => {
        modal.classList.add('is-active');
    });

    cancelButton.addEventListener('click', () => {
        modal.classList.remove('is-active');
    });

    modalClose.addEventListener('click', () => {
        modal.classList.remove('is-active');
    });
});
</script>


{% endblock %}